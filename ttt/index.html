<!DOCTYPE html>

<head>
    <title>Tic Tac Toe</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <canvas id="canvas" width="600" height="600">
        <script>
            var ctx = undefined
            var player = 1;
            var gameOver = false;
            var board = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];

            function drawBoard() {
                ctx.beginPath();
                ctx.moveTo(0, 200);
                ctx.lineTo(600, 200);
                ctx.moveTo(0, 400);
                ctx.lineTo(600, 400);
                ctx.moveTo(200, 0);
                ctx.lineTo(200, 600);
                ctx.moveTo(400, 0);
                ctx.lineTo(400, 600);
                ctx.stroke();
            }

            function drawX(x, y) {
                ctx.beginPath();
                ctx.moveTo(x * 200, y * 200);
                ctx.lineTo(x * 200 + 200, y * 200 + 200);
                ctx.moveTo(x * 200 + 200, y * 200);
                ctx.lineTo(x * 200, y * 200 + 200);
                ctx.stroke();
            }

            function drawO(x, y) {
                ctx.beginPath();
                ctx.arc(x * 200 + 100, y * 200 + 100, 100, 0, 2 * Math.PI);
                ctx.stroke();
            }

            function checkWin() {
                for (var i = 0; i < 3; i++) {
                    if (board[i][0] == board[i][1] && board[i][1] == board[i][2] && board[i][0] != 0) {
                        return board[i][0];
                    }
                    if (board[0][i] == board[1][i] && board[1][i] == board[2][i] && board[0][i] != 0) {
                        return board[0][i];
                    }
                }
                if (board[0][0] == board[1][1] && board[1][1] == board[2][2] && board[0][0] != 0) {
                    return board[0][0];
                }
                if (board[0][2] == board[1][1] && board[1][1] == board[2][0] && board[0][2] != 0) {
                    return board[0][2];
                }
                return 0;
            }

            function game() {
                var canvas = document.getElementById('canvas');
                ctx = canvas.getContext('2d');

                ctx.strokeStyle = 'black';
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawBoard();

                for (var i = 0; i < 3; i++) {
                    for (var j = 0; j < 3; j++) {
                        if (board[i][j] == 1) {
                            drawX(j, i);
                        } else if (board[i][j] == 2) {
                            drawO(j, i);
                        }
                    }
                }

                requestAnimationFrame(game);
            }
            function isBoardFull() {
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j < 3; j++) {
                        if (board[i][j] == 0) {
                            return false;
                        }
                    }
                }

                return true
            }

            function resetBoard() {
                board = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];
                player = 1
                gameOver = false;
            }

            window.onload = () => {
                requestAnimationFrame(game);

                canvas.addEventListener("click", (ev) => {
                    var x = Math.floor(ev.offsetX / 200);
                    var y = Math.floor(ev.offsetY / 200);

                    if (board[y][x] === 0) {
                        if (player == 1) {
                            board[y][x] = 1;
                            player = 2;
                        } else {
                            board[y][x] = 2;
                            player = 1;
                        }
                    }


                    var winner = checkWin();
                    if (winner != 0) {

                        setTimeout(() => {
                            alert("Player " + winner + " wins!");
                            resetBoard()
                        }, 200)

                    } else if (isBoardFull() && winner == 0) {
                        setTimeout(() => {
                            alert("Draw");
                            resetBoard()
                        }, 200)

                    }
                })
            }

        </script>
</body>
